---
- name: "Load OS variables"
  ansible.builtin.include_vars: "{{ ansible_os_family }}.yml"

- name: 'install sos'
  ansible.builtin.package:
    name: '{{ sos_package }}'
    state: present

- name: 'Generate sosreport'
  ansible.builtin.command: "sosreport --batch --tmp-dir={{ sosreport_output_dir }}"
  ignore_errors: true

- ansible.builtin.include_tasks: 'sosreport_fetch_results.yml'
  when: sosreport_fetch
